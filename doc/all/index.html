<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>the Drupal Extension to Behat and Mink 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="None" href="index.html#document-index" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-the-drupal-extension-to-behat-and-mink-s-documentation">
<h1>Welcome to the Drupal Extension to Behat and Mink&#8217;s documentation!<a class="headerlink" href="#welcome-to-the-drupal-extension-to-behat-and-mink-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-intro"></span><div class="section" id="testing-your-site-with-the-drupal-extension-to-behat-and-mink">
<h2>Testing your site with the Drupal Extension to Behat and Mink<a class="headerlink" href="#testing-your-site-with-the-drupal-extension-to-behat-and-mink" title="Permalink to this headline">¶</a></h2>
<div class="clear container">
<a class="reference internal image-reference" href="_images/beehat.png"><img alt="_images/beehat.png" class="align-left" src="_images/beehat.png" style="height: 125px;" /></a>
</div>
<p>The <a class="reference external" href="https://drupal.org/project/drupalextension">Drupal Extension to Behat and Mink</a> provides Drupal-specific functionality for the <a class="reference external" href="http://dannorth.net/introducing-bdd/">Behavior-Driven Development</a> testing frameworks of <a class="reference external" href="http://extensions.behat.org/mink/">Behat and Mink</a>.</p>
<div class="section" id="what-do-behat-and-mink-do">
<h3>What do Behat and Mink Do?<a class="headerlink" href="#what-do-behat-and-mink-do" title="Permalink to this headline">¶</a></h3>
<p>Behat and Mink allow you to describe the behavior of a web site in plain, but stylized language, and then turn that description into an automated test that will visit the site and perform each step you describe. Such functional tests can help site builders ensure that the added value they&#8217;ve created when building a Drupal site continues to behave as expected after any sort of site change &#8211; security updates, new module versions, changes to custom code, etc.</p>
</div>
<div class="section" id="what-does-the-drupal-extension-add">
<h3>What does the Drupal Extension add?<a class="headerlink" href="#what-does-the-drupal-extension-add" title="Permalink to this headline">¶</a></h3>
<p>The Drupal Extension to Behat and Mink assists in the performance of these common Drupal testing tasks:</p>
<ul class="simple">
<li>Set up test data with Drush or the Drupal API</li>
<li>Define theme regions and test data appears within them</li>
<li>Clear the cache, log out, and other useful steps</li>
<li>Detect and discover steps provided by contributed modules and themes</li>
</ul>
</div>
</div>
<span id="document-requirements"></span><div class="section" id="system-requirements">
<h2>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="meet-the-system-requirements">
<h3>Meet the system requirements<a class="headerlink" href="#meet-the-system-requirements" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Check your PHP version:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">php</span> <span class="o">--</span><span class="n">version</span>
</pre></div>
</div>
<p>It must be higher than 5.3.5! Note: This means you cannot use the same
version of PHP for testing that you might use to run a Drual 5 site.</p>
</li>
</ol>
<blockquote>
<div><p>PHP will also need to have the following libraries installed:</p>
<ul class="simple">
<li><a class="reference external" href="http://curl.haxx.se/libcurl/php/install.html">curl</a></li>
<li><a class="reference external" href="http://php.net/manual/en/mbstring.installation.php">mbstring</a></li>
<li><a class="reference external" href="http://www.php.net/manual/en/dom.setup.php#102046">xml</a></li>
</ul>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">Check for Java:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">java</span> <span class="o">-</span><span class="n">version</span>
</pre></div>
</div>
<p>It doesn&#8217;t necessarily matter what version, but it will be required for
Selenium.</p>
</li>
<li><p class="first">Directions are written to use commandline cURL. You can make sure it&#8217;s
installed with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">curl</span> <span class="o">--</span><span class="n">version</span>
</pre></div>
</div>
</li>
<li><p class="first">Selenium</p>
</li>
</ol>
<blockquote>
<div><p>Download the latest version of <a class="reference external" href="http://docs.seleniumhq.org/download/">Selenium Server</a> It&#8217;s under the heading Selenium
Server (formerly the Selenium RC Server).   This is a single file which can be
placed any where you like on your system and run with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>java -jar selenium-server-standalone-2.33.0.jar &amp;
// replace with the name of the version you downloaded
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<span id="document-localinstall"></span><div class="section" id="stand-alone-installation">
<h2>Stand-alone installation<a class="headerlink" href="#stand-alone-installation" title="Permalink to this headline">¶</a></h2>
<p>A stand-alone installation is recommended when you want your tests and testing
environment to be portable, from local development to CI server, to client
infrastructure. It also make documentation consistent and reliable.</p>
<ol class="arabic">
<li><p class="first">Create a folder for your BDD tests:</p>
<div class="highlight-python"><div class="highlight"><pre>mkdir projectfolder cd projectfolder
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div>All the commands that follow are written to install from the root of your
project folder.</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">Install Composer, a php package manager:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -s https://getcomposer.org/installer | php
</pre></div>
</div>
</li>
<li><p class="first">Create a composer.json file to tell Composer what to install.  To do that,
paste the following code into your editor and save as composer.json. The
Drupal Extension requires Behat, Mink, and the Mink Extension. The will all
be set up because they&#8217;re dependencies of the Drupal Extension, so you don&#8217;t
have to specify them directly in the composer.json file:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;require&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;drupal/drupal-extension&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0.*@stable&quot;</span>
<span class="p">},</span>
  <span class="s2">&quot;config&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;bin-dir&quot;</span><span class="o">:</span> <span class="s2">&quot;bin/&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">Run the following command to install the Drupal Extension and all those
dependencies. This takes a while before you start to see output:</p>
<div class="highlight-python"><div class="highlight"><pre>php composer.phar install
</pre></div>
</div>
</li>
<li><p class="first">Configure your testing environment by creating a file called behat.yml with
the following. Be sure that you point the base_url at the web site YOU intend
to test. Do not include a trailing slash:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic" start="6">
<li><p class="first">Initialze behat. This creates the features folder with some basic things to
get you started, including your own FeatureContext.php file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">behat</span> <span class="o">--</span><span class="n">init</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit features/bootstrap/FeatureContext.php so that it matches the following:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Behat\Behat\Context\ClosuredContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\TranslatedContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\BehatContext</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Exception\PendingException</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Behat\Gherkin\Node\PyStringNode</span><span class="p">,</span>
    <span class="nx">Behat\Gherkin\Node\TableNode</span><span class="p">;</span>

<span class="c1">//</span>
<span class="c1">// Require 3rd-party libraries here:</span>
<span class="c1">//</span>
<span class="c1">//   require_once &#39;PHPUnit/Autoload.php&#39;;</span>
<span class="c1">//   require_once &#39;PHPUnit/Framework/Assert/Functions.php&#39;;</span>
<span class="c1">//</span>

<span class="sd">/**</span>
<span class="sd"> * Features context.</span>
<span class="sd"> */</span>
<span class="hll"><span class="c1">// class FeatureContext extends BehatContext </span>
</span><span class="hll"><span class="k">class</span> <span class="nc">FeatureContext</span> <span class="k">extends</span> <span class="nx">Drupal\DrupalExtension\Context\DrupalContext</span>
</span><span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Initializes context.</span>
<span class="sd">     * Every scenario gets its own context object.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array $parameters context parameters (set them in behat.yml)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Initialize your context here</span>
    <span class="p">}</span>

<span class="c1">//</span>
<span class="c1">// Place your definition and hook methods here:</span>
<span class="c1">//</span>
<span class="c1">//    /**</span>
<span class="c1">//     * @Given /^I have done something with &quot;([^&quot;]*)&quot;$/</span>
<span class="c1">//     */</span>
<span class="c1">//    public function iHaveDoneSomethingWith($argument)</span>
<span class="c1">//    {</span>
<span class="c1">//        doSomethingWith($argument);</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This will make your FeatureContext.php aware of both the Drupal Extension and
the Mink Extension, so you&#8217;ll be able to take advantage of their drivers and
step definitions and add your own custom step definitions as well.</p>
</div></blockquote>
<ol class="arabic" start="8">
<li><p class="first">To ensure everything is set up appropriately, type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">behat</span> <span class="o">-</span><span class="n">dl</span>
</pre></div>
</div>
<p>You&#8217;ll see a list of steps like the following, but longer, if you&#8217;ve
installed everything successfully:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="nf"> </span><span class="k">Given </span><span class="nf">/^(?:that I|I) am at &quot;</span><span class="s">(?P[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     - Visit a given path, and additionally check for HTTP response code</span>
<span class="s">       200.</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iAmAt()</span>

<span class="s">  When /^I visit </span><span class="nf">&quot;(?P[^&quot;</span><span class="s">]*)</span><span class="nf">&quot;$/</span>
<span class="nf">     </span><span class="c"># Drupal\DrupalExtension\Context\DrupalContext::iVisit()</span><span class="nf"></span>

<span class="nf">  </span><span class="k">When </span><span class="nf">/^I click &quot;</span><span class="s">(?P</span><span class="nv">&lt;link&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iClick()</span>

<span class="s"> Given /^for </span><span class="nf">&quot;(?P</span><span class="nv">&lt;field&gt;</span><span class="nf">[^&quot;</span><span class="s">]*)</span><span class="nf">&quot; I enter &quot;</span><span class="s">(?P</span><span class="nv">&lt;value&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::forIenter()</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
<span id="document-globalinstall"></span><div class="section" id="system-wide-installation">
<h2>System-wide installation<a class="headerlink" href="#system-wide-installation" title="Permalink to this headline">¶</a></h2>
<p>A system-wide installation allows you to maintain a single copy of the testing
toolset and use it for multiple test environments. Configuuration is slightly
more complex than the stand-alone installation but many people prefer the
flexibility and ease-of-maintenance this setup provides.</p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>To install the Drupal Extension globally:</p>
<ol class="arabic simple">
<li>Install Composer</li>
<li>Install the Drupal Extension in <cite>/opt/drupalextension</cite></li>
<li>Create an alias to the behat binary in <cite>/usr/local/bin</cite></li>
<li>Create your test folder</li>
</ol>
</div>
<div class="section" id="install-composer">
<h3>Install Composer<a class="headerlink" href="#install-composer" title="Permalink to this headline">¶</a></h3>
<p>Composer is a PHP dependency manager that will make sure all the pieces you
need get installed. <a class="reference external" href="http://getcomposer.org/doc/00-intro.md#globally">Full directions for global installation</a> and more information can be
found on the <a class="reference external" href="http://getcomposer.org/">Composer website</a>.:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -sS https://getcomposer.org/installer |
php mv composer.phar /usr/local/bin/composer
</pre></div>
</div>
</div>
<div class="section" id="install-the-drupal-extension">
<h3>Install the Drupal Extension<a class="headerlink" href="#install-the-drupal-extension" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Make a directory in /opt (or wherever you choose) for the Drupal Extension:</p>
<div class="highlight-python"><div class="highlight"><pre>cd opt/
mkdir drupalextension
cd drupalextension/
</pre></div>
</div>
</li>
</ol>
<ol class="arabic simple" start="2">
<li>Create a file called <cite>composer.json</cite> and include the following:</li>
</ol>
<blockquote>
<div><div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;require&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;drupal/drupal-extension&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0.*@stable&quot;</span>
<span class="p">},</span>
  <span class="s2">&quot;config&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;bin-dir&quot;</span><span class="o">:</span> <span class="s2">&quot;bin/&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p class="first">Run the install command:</p>
<div class="highlight-python"><div class="highlight"><pre>composer install
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div>It will be a bit before you start seeing any output. It will also suggest
that you install additional tools, but they&#8217;re not normally needed so you can
savely ignore that message.</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">Test that your install worked by typing the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">behat</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>If you were successful, you&#8217;ll see the help output.</p>
</li>
<li><p class="first">Make the binary available system-wide:</p>
<div class="highlight-python"><div class="highlight"><pre>ln -s behat /usr/local/bin/behat
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="set-up-tests">
<h3>Set up tests<a class="headerlink" href="#set-up-tests" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Create the directory that will hold your tests. There is no technical
reason this needs to be inside the Drupal directory at all. It is best to
keep them in the same version control repository so that the tests match the
version of the site they are written for.</li>
</ol>
<blockquote>
<div><p>One clear pattern is to keep them in the sites folder as follows:</p>
<p>Single site: <cite>sites/default/behat-tests</cite></p>
<p>Multisite or named single site: <cite>/sites/my.domain.com/behat-tests</cite></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Wherever you make your test folder, inside it create the behat.yml file:</li>
</ol>
<blockquote>
<div><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Edit features/bootstrap/FeatureContext.php so that it matches the following:</li>
</ol>
<blockquote>
<div><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Behat\Behat\Context\ClosuredContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\TranslatedContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\BehatContext</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Exception\PendingException</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Behat\Gherkin\Node\PyStringNode</span><span class="p">,</span>
    <span class="nx">Behat\Gherkin\Node\TableNode</span><span class="p">;</span>

<span class="c1">//</span>
<span class="c1">// Require 3rd-party libraries here:</span>
<span class="c1">//</span>
<span class="c1">//   require_once &#39;PHPUnit/Autoload.php&#39;;</span>
<span class="c1">//   require_once &#39;PHPUnit/Framework/Assert/Functions.php&#39;;</span>
<span class="c1">//</span>

<span class="sd">/**</span>
<span class="sd"> * Features context.</span>
<span class="sd"> */</span>
<span class="hll"><span class="c1">// class FeatureContext extends BehatContext </span>
</span><span class="hll"><span class="k">class</span> <span class="nc">FeatureContext</span> <span class="k">extends</span> <span class="nx">Drupal\DrupalExtension\Context\DrupalContext</span>
</span><span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Initializes context.</span>
<span class="sd">     * Every scenario gets its own context object.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array $parameters context parameters (set them in behat.yml)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Initialize your context here</span>
    <span class="p">}</span>

<span class="c1">//</span>
<span class="c1">// Place your definition and hook methods here:</span>
<span class="c1">//</span>
<span class="c1">//    /**</span>
<span class="c1">//     * @Given /^I have done something with &quot;([^&quot;]*)&quot;$/</span>
<span class="c1">//     */</span>
<span class="c1">//    public function iHaveDoneSomethingWith($argument)</span>
<span class="c1">//    {</span>
<span class="c1">//        doSomethingWith($argument);</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This will make your FeatureContext.php aware of both the Drupal Extension and
the Mink Extension, so you&#8217;ll be able to take advantage of their drivers and
step definitions and add your own custom step definitions here.</p>
</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">To ensure everything is set up appropriately, type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">behat</span> <span class="o">-</span><span class="n">dl</span>
</pre></div>
</div>
<p>You&#8217;ll see a list of steps like the following, but longer, if you&#8217;ve
installed everything successfully:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="nf"> </span><span class="k">Given </span><span class="nf">/^(?:that I|I) am at &quot;</span><span class="s">(?P[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     - Visit a given path, and additionally check for HTTP response code</span>
<span class="s">       200.</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iAmAt()</span>

<span class="s">  When /^I visit </span><span class="nf">&quot;(?P[^&quot;</span><span class="s">]*)</span><span class="nf">&quot;$/</span>
<span class="nf">     </span><span class="c"># Drupal\DrupalExtension\Context\DrupalContext::iVisit()</span><span class="nf"></span>

<span class="nf">  </span><span class="k">When </span><span class="nf">/^I click &quot;</span><span class="s">(?P</span><span class="nv">&lt;link&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iClick()</span>

<span class="s"> Given /^for </span><span class="nf">&quot;(?P</span><span class="nv">&lt;field&gt;</span><span class="nf">[^&quot;</span><span class="s">]*)</span><span class="nf">&quot; I enter &quot;</span><span class="s">(?P</span><span class="nv">&lt;value&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::forIenter()</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
</div>
<span id="document-drivers"></span><div class="section" id="drupal-extension-drivers">
<h2>Drupal Extension Drivers<a class="headerlink" href="#drupal-extension-drivers" title="Permalink to this headline">¶</a></h2>
<p>The Drupal Extension provides drivers for interacting with your site which are
compatible with Drupal 6, 7, and 8. Each driver has its own limitiations.</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="19%" />
<col width="13%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Feature</th>
<th class="head">Blackbox</th>
<th class="head">Drush</th>
<th class="head">Drupal API</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Map Regions</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Create users</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Create nodes</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Create vocabularies</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Create taxonomy terms</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Run tests and site
on different servers</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<span id="document-blackbox"></span><div class="section" id="blackbox-driver">
<h2>Blackbox Driver<a class="headerlink" href="#blackbox-driver" title="Permalink to this headline">¶</a></h2>
<p>The blackbox driver assumes no privileged access to the site. You can run the
tests on a local or remote server, and all the actions will take place through
the site&#8217;s user interface. This driver was enabled as part of the installation
instructions by lines 9 and 10, highlighted below.</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
<span class="hll">    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
</span><span class="hll">      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</span>      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="region-steps">
<h3>Region steps<a class="headerlink" href="#region-steps" title="Permalink to this headline">¶</a></h3>
<p>It may be really important that a block is in the correct region, or you may
have a link or button that doesn&#8217;t have a unique label. The blackbox driver
allows you to create a map between a CSS selector and a user-readable region
name so you can use steps like the following without having to write any custom
PHP:</p>
<div class="highlight-python"><div class="highlight"><pre>I press &quot;Search&quot; in the &quot;header&quot; region
I fill in &quot;a value&quot; for &quot;a field&quot; in the &quot;content&quot; region
I fill in &quot;a field&quot; with &quot;Stuff&quot; in the &quot;header&quot; region
I click &quot;About us&quot; in the &quot;footer&quot; region
</pre></div>
</div>
</div>
<div class="section" id="example">
<h3>Example:<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>A stock Drupal 7 installation has a footer area identified by the CSS Id
&#8220;footer&#8221;. By editing the behat.yml file and adding lines 11 and 12 below:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
<span class="hll">      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
</span><span class="hll">        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>You can use a step like the following without writing any custom PHP:</p>
<div class="highlight-python"><div class="highlight"><pre>When I click &quot;About us&quot; in the &quot;footer&quot; region.
</pre></div>
</div>
<p>Using the blackbox driver, you can use all of the steps in the examples below.</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Test DrupalContext</span>
<span class="nf">  In order to prove the Drupal context using the blackbox driver is working </span>
<span class="nf">    properly</span>
<span class="nf">  As a developer</span>
<span class="nf">  I need to use the step definitions of this context</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Test the ability to find a heading in a region</span>
<span class="k">    Given </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">Download &amp; Extend</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">Core</span><span class="nf">&quot; in the &quot;</span><span class="s">content</span><span class="nf">&quot; region</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Clicking content in a region</span>
<span class="k">    Given </span><span class="nf">I am at &quot;</span><span class="s">download</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">About Distributions</span><span class="nf">&quot; in the &quot;</span><span class="s">content</span><span class="nf">&quot; region</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see &quot;</span><span class="s">Page status</span><span class="nf">&quot; in the &quot;</span><span class="s">right sidebar</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see the link &quot;</span><span class="s">Drupal News</span><span class="nf">&quot; in the &quot;</span><span class="s">footer</span><span class="nf">&quot; region</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Viewing content in a region</span>
<span class="k">    Given </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see &quot;</span><span class="s">Come for the software, stay for the community</span><span class="nf">&quot; </span>
<span class="nf">      in the &quot;</span><span class="s">left header</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Test ability to find text that should not appear in a region</span>
<span class="k">    Given </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should not see the text &quot;</span><span class="s">Proprietary software is cutting edge</span><span class="nf">&quot; </span>
<span class="nf">      in the &quot;</span><span class="s">left header</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Press a button in a region</span>
<span class="k">    Given </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I press &quot;</span><span class="s">Search</span><span class="nf">&quot; in the &quot;</span><span class="s">right header</span><span class="nf">&quot; region</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the text &quot;</span><span class="s">Filter by content type</span><span class="nf">&quot; in the &quot;</span><span class="s">content</span><span class="nf">&quot; region</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Check a link should not exist in a region</span>
<span class="k">    Given </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should not see the link &quot;</span><span class="s">This link should never exist in a </span>
<span class="s">      default Drupal install</span><span class="nf">&quot; in the &quot;</span><span class="s">right header</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Error messages</span>
<span class="k">   Given </span><span class="nf">I am on &quot;</span><span class="s">/user</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">When </span><span class="nf">I press &quot;</span><span class="s">Log in</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">Then </span><span class="nf">I should see the error message &quot;</span><span class="s">Password field is required</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">And </span><span class="nf">I should not see the error message &quot;</span><span class="s">Sorry, </span>
<span class="s">     unrecognized username or password</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">And </span><span class="nf">I should see the following </span><span class="nv">&lt;error messages&gt;</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> error messages</span><span class="k">             |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Username field is required</span><span class="k"> |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Password field is required</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">   </span><span class="k">And </span><span class="nf">I should not see the following </span><span class="nv">&lt;error messages&gt;</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> error messages</span><span class="k">                                                          |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Sorry, unrecognized username or password</span><span class="k">                                | </span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Unable to send e-mail. Contact the site administrator if the problem </span>
<span class="s">     persists</span><span class="k">                                                                |</span>

<span class="nf"> </span><span class="k">Scenario:</span><span class="nf"> Messages</span>
<span class="k">   Given </span><span class="nf">I am on &quot;</span><span class="s">/user/register</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">When </span><span class="nf">I press &quot;</span><span class="s">Create new account</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">Then </span><span class="nf">I should see the message &quot;</span><span class="s">Username field is required</span><span class="nf">&quot;</span>
<span class="nf">   </span><span class="k">But </span><span class="nf">I should not see the message &quot;</span><span class="s">Registration successful. You are </span>
<span class="s">     now logged in</span><span class="nf">&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<span id="document-drush"></span><div class="section" id="drush-driver">
<h2>Drush Driver<a class="headerlink" href="#drush-driver" title="Permalink to this headline">¶</a></h2>
<p>Many tests require that a user logs into the site. With the blackbox driver,
all user creation and login would have to take place via the user interface,
which quickly becomes tedious and time consuming. You can use the Drush driver
to add users, reset passwords, and log in by following the steps below, again,
without having to write custom PHP. You can also do this with the Drupal API
driver. The main advantage of the Drush driver is that it can work when your
tests run on a different server than the site being tested.</p>
<div class="section" id="install-drush">
<h3>Install Drush<a class="headerlink" href="#install-drush" title="Permalink to this headline">¶</a></h3>
<p>See the <a class="reference external" href="https://drupal.org/project/drush">Drush project page</a> for
installation directions.</p>
</div>
<div class="section" id="create-a-drush-alias">
<h3>Create a Drush alias<a class="headerlink" href="#create-a-drush-alias" title="Permalink to this headline">¶</a></h3>
<p>You&#8217;ll need ssh-key access to a remote server to use Drush. If Drush and Drush
aliases are new to you, see the <a class="reference external" href="http://drush.ws/help">Drush site</a> for
<a class="reference external" href="http://drush.ws/examples/example.aliases.drushrc.php">detailed examples</a></p>
<p>The alias for our example looks like:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$aliases</span><span class="p">[</span><span class="s1">&#39;local&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">&#39;root&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/www/seven/drupal&#39;</span><span class="p">,</span>
  <span class="s1">&#39;uri&#39;</span>  <span class="o">=&gt;</span>  <span class="s1">&#39;seven.l&#39;</span>
<span class="p">);</span>
<span class="nv">$aliases</span><span class="p">[</span><span class="s1">&#39;git7site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">&#39;uri&#39;</span>  <span class="o">=&gt;</span>  <span class="s1">&#39;git7site.devdrupal.org&#39;</span><span class="p">,</span>
  <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;git7site.devdrupal.org&#39;</span>
<span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="enable-the-drush-driver-in-the-behat-yml">
<h3>Enable the Drush driver in the behat.yml<a class="headerlink" href="#enable-the-drush-driver-in-the-behat-yml" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
<span class="hll">      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drush&#39;</span> 
</span><span class="hll">      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
</span>        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Line 11 isn&#8217;t strictly necessary for the Drush driver, which is the
default for the API.</p>
</div>
</div>
<div class="section" id="calling-the-drush-driver">
<h3>Calling the Drush driver<a class="headerlink" href="#calling-the-drush-driver" title="Permalink to this headline">¶</a></h3>
<p>Untagged tests use the blackbox driver. To invoke the Drush driver, tag the
scenario with &#64;api</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Drush alias</span>
<span class="nf">  In order to demonstrate the Drush driver</span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to show how to tag scenarios </span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Untagged scenario uses blackbox driver and fails</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>

<span class="hll"><span class="nf">  </span><span class="nt">@api</span><span class="nf"></span>
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Tagged scenario uses Drush driver and succeeds</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>
</pre></div>
</td></tr></table></div>
<p>If you try to run a test without that tag, it will fail.</p>
<p>Example:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Drush alias</span>
<span class="nf">  In order to demonstrate the Drush driver</span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to show how to tag scenarios</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Untagged scenario uses blackbox driver and fails</span>
<span class="nf">    </span><span class="c"># features/drush.feature:6</span><span class="nf"></span>
<span class="hll"><span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role </span>
</span><span class="hll"><span class="nf">    </span><span class="c"># FeatureContext::iAmLoggedInWithRole()</span><span class="nf"></span>
</span><span class="hll"><span class="nf">      No ability to create users in Drupal\Driver\BlackboxDriver. </span>
</span><span class="nf">      Put `</span><span class="nt">@api`</span><span class="nf"> into your feature and add an api driver </span>
<span class="nf">      (ex: `api_driver: drupal`) in behat.yml.</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;                                         </span>
<span class="nf">    </span><span class="c"># FeatureContext::iClick()</span><span class="nf"></span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;                           </span>
<span class="nf">    </span><span class="c"># FeatureContext::assertHeading()</span><span class="nf"></span>

<span class="nf">  </span><span class="nt">@api</span><span class="nf"></span>
<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Tagged scenario uses Drush driver and succeeds            </span>
<span class="nf">            </span><span class="c"># features/drush.feature:12</span><span class="nf"></span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role </span>
<span class="nf">    </span><span class="c"># FeatureContext::iAmLoggedInWithRole()</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;                                         </span>
<span class="nf">    </span><span class="c"># FeatureContext::iClick()</span><span class="nf"></span>
</pre></div>
</td></tr></table></div>
<p>The Drush driver give you access to all the blackbox steps, plus those used in
each of the following examples:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">@api</span><span class="nf"></span>
<span class="k">Feature:</span><span class="nf"> Drush driver</span>
<span class="nf">  In order to show functionality added by the Drush driver </span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to use the step definitions it supports</span>

<span class="nf">  # These scenarios assume a &quot;standard&quot; install of Drupal 7.</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Drush alias</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Target links within table rows</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am at &quot;</span><span class="s">admin/structure/types</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I click &quot;</span><span class="s">manage fields</span><span class="nf">&quot; in the &quot;</span><span class="s">Article</span><span class="nf">&quot; row</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should be on &quot;</span><span class="s">admin/structure/types/manage/article/fields</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see text matching &quot;</span><span class="s">Add new field</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Clear cache</span>
<span class="k">    Given </span><span class="nf">the cache has been cleared</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should get a &quot;</span><span class="s">200</span><span class="nf">&quot; HTTP response</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<span id="document-drupalapi"></span><div class="section" id="drupal-api-driver">
<h2>Drupal API Driver<a class="headerlink" href="#drupal-api-driver" title="Permalink to this headline">¶</a></h2>
<p>The Drupal API Driver is the fastest and the most powerful of the three
drivers. Its biggest limitation is that the tests must run on the same server
as the Drupal site.</p>
<div class="section" id="enable-the-drupal-api-driver">
<h3>Enable the Drupal API Driver<a class="headerlink" href="#enable-the-drupal-api-driver" title="Permalink to this headline">¶</a></h3>
<p>To enable the Drupal API driver, edit the behat.yml file, change the api_driver
to drupal and add the path to the local Drupal installation as shown below:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="x">default:</span>
<span class="x">  paths:</span>
<span class="x">    features: &#39;features&#39;</span>
<span class="x">  extensions:</span>
<span class="x">    Behat\MinkExtension\Extension:</span>
<span class="x">      goutte: ~</span>
<span class="x">      selenium2: ~</span>
<span class="x">      base_url: http://seven.l</span>
<span class="x">    Drupal\DrupalExtension\Extension:</span>
<span class="x">      blackbox: ~</span>
<span class="hll"><span class="x">      api_driver: &#39;drupal&#39; </span>
</span><span class="x">      drush:</span>
<span class="x">        alias: &#39;local&#39;</span>
<span class="x">      drupal: </span>
<span class="x">        drupal_root: &#39;/var/www/seven/drupal&#39; </span>
<span class="x">      region_map:</span>
<span class="x">        footer: &quot;#footer&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It&#8217;s fine to leave the information for the drush driver in the file. It&#8217;s
the api_driver value that declares which setting will be used for scenarios
tagged &#64;api.</p>
</div>
<p>Using this driver, you gain the ability to use all the steps in the
examples below:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">    |</span><span class="s"> First article with fields</span><span class="k"> |</span><span class="s">       1</span><span class="k"> |</span><span class="s"> PLACEHOLDER BODY</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">follow &quot;</span><span class="s">First article with fields</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the text &quot;</span><span class="s">PLACEHOLDER BODY</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create and view a node with fields</span>
<span class="k">    Given </span><span class="nf">I am viewing an &quot;</span><span class="s">Article</span><span class="nf">&quot; node:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k"> |</span><span class="s"> My article with fields!</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> body</span><span class="k">  |</span><span class="s"> A placeholder</span><span class="k">           |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">My article with fields!</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see the text &quot;</span><span class="s">A placeholder</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create users</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">     |</span><span class="s"> mail</span><span class="k">            |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> joe@example.com</span><span class="k"> |</span><span class="s"> 1</span><span class="k">      |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I visit &quot;</span><span class="s">admin/people</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Joe User</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Login as a user created during this scenario</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">      |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Test user</span><span class="k"> |</span><span class="s">      1</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am logged in as &quot;</span><span class="s">Test user</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Log out</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create a term</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am viewing a &quot;</span><span class="s">tags</span><span class="nf">&quot; term with the name &quot;</span><span class="s">My tag</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">My tag</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create many terms</span>
<span class="k">    Given </span><span class="nf">&quot;</span><span class="s">tags</span><span class="nf">&quot; terms:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">    |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag one</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag two</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I go to &quot;</span><span class="s">admin/structure/taxonomy/tags</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see &quot;</span><span class="s">Tag one</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see &quot;</span><span class="s">Tag two</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create nodes with specific authorship</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">     |</span><span class="s"> mail</span><span class="k">            |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> joe@example.com</span><span class="k"> |</span><span class="s"> 1</span><span class="k">      |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">&quot;</span><span class="s">article</span><span class="nf">&quot; nodes:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k">          |</span><span class="s"> author</span><span class="k">   |</span><span class="s"> body</span><span class="k">             |</span><span class="s"> promote</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Article by Joe</span><span class="k"> |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> PLACEHOLDER BODY</span><span class="k"> |</span><span class="s"> 1</span><span class="k">       |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I follow &quot;</span><span class="s">Article by Joe</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Joe User</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create an article with multiple term references</span>
<span class="k">    Given </span><span class="nf">&quot;</span><span class="s">tags</span><span class="nf">&quot; terms:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">      |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag one</span><span class="k">   |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag two</span><span class="k">   |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag three</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag four</span><span class="k">  |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">&quot;</span><span class="s">article</span><span class="nf">&quot; nodes:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k"> |</span><span class="s"> body</span><span class="k"> |</span><span class="s"> promote</span><span class="k"> |</span><span class="s"> field_tags</span><span class="k"> |</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<span id="document-subcontexts"></span><div class="section" id="contributed-module-subcontexts">
<h2>Contributed Module Subcontexts<a class="headerlink" href="#contributed-module-subcontexts" title="Permalink to this headline">¶</a></h2>
<p>Although not yet a wide-spread practice, the Drupal Extension to Behat and Mink
makes it easy for maintainers to include custom step definitions in their
contributed projects.</p>
<div class="section" id="discovering-subcontexts">
<h3>Discovering SubContexts<a class="headerlink" href="#discovering-subcontexts" title="Permalink to this headline">¶</a></h3>
<p>In order to use contributed step definitions, define the search path in the
behat.yml</p>
<p>// sites/default/behat-tests/behat.yml</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drupal&#39;</span> 
      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">drupal</span><span class="p-Indicator">:</span> 
        <span class="l-Scalar-Plain">drupal_root</span><span class="p-Indicator">:</span> <span class="s">&#39;/var/www/seven/drupal&#39;</span> 
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
<span class="hll">      <span class="l-Scalar-Plain">subcontexts</span><span class="p-Indicator">:</span>
</span><span class="hll">        <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
</span><span class="hll">          <span class="p-Indicator">-</span> <span class="s">&quot;/var/www/seven/drupal/sites/all&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>The Drupal Extension will search recursively within the directory or
directories specified to discover and load any file ending in behat.inc This
system, although created with Drupal contrib projects in mind, searches where
it&#8217;s pointed, so you can also use it for your own subcontexts, a strategy you
might employ to re-use step definitions particular to your shop or company&#8217;s
development patterns.</p>
</div>
<div class="section" id="disable-autoloading">
<h3>Disable autoloading<a class="headerlink" href="#disable-autoloading" title="Permalink to this headline">¶</a></h3>
<p>Autoloading can be disabled in the behat.yml file temorarily with the
following:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drupal&#39;</span> 
      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">drupal</span><span class="p-Indicator">:</span> 
        <span class="l-Scalar-Plain">drupal_root</span><span class="p-Indicator">:</span> <span class="s">&#39;/var/www/seven/drupal&#39;</span> 
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
      <span class="l-Scalar-Plain">subcontexts</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
          <span class="p-Indicator">-</span> <span class="s">&quot;/var/www/seven/drupal/sites/all&quot;</span>
<span class="hll">        <span class="l-Scalar-Plain">autoload</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="section" id="for-contributors">
<h3>For Contributors<a class="headerlink" href="#for-contributors" title="Permalink to this headline">¶</a></h3>
<p>Read a detailed discussion of <a class="reference external" href="http://docs.behat.org/guides/4.context.html#using-subcontexts">using sucontexts</a> on the Behat
site.</p>
<p>With regard to the Drupal Extension:</p>
<ul class="simple">
<li>Save custom step definitions in a file ending with <cite>.behat.inc</cite> Just like
functions, preface the filename with the project&#8217;s machine name to prevent
namespace collisions.</li>
<li>Writing step definitions for the subcontext is only slighly different than
writing them for the main context.</li>
</ul>
<p>Your subcontext must include, at a minimum, lines 7 and 8 below.</p>
<p>// sites/all/modules/beanslide/beanslide.behat.inc</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Provide Behat step-definitions as Drupal Extension subcontexts.</span>
<span class="sd"> */</span>

<span class="hll"><span class="k">use</span> <span class="nx">Drupal\DrupalExtension\Context\DrupalSubContextInterface</span><span class="p">;</span>
</span><span class="hll"><span class="k">use</span> <span class="nx">Behat\Behat\Context\BehatContext</span><span class="p">;</span>
</span>
<span class="hll"><span class="k">class</span> <span class="nc">BeanslideSubContext</span> <span class="k">extends</span> <span class="nx">BehatContext</span> <span class="k">implements</span> 
</span><span class="hll">  <span class="nx">DrupalSubContextInterface</span> <span class="p">{</span>
</span><span class="hll">  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getAlias</span><span class="p">()</span> <span class="p">{</span>
</span>    <span class="k">return</span> <span class="s1">&#39;beanslide&#39;</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>You&#8217;ll also need to call the main context in order to access the session:</p>
<p>// sites/all/modules/beanslide/beanslide.behat.inc</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span> 

  <span class="sd">/**</span>
<span class="sd">   * @Then /^I should see a slideshow$/</span>
<span class="hll"><span class="sd">   */</span>
</span>  <span class="k">public</span> <span class="k">function</span> <span class="nf">assertSlideshowExists</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$slideshow</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMainContext</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getPage</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">,</span> <span class="s1">&#39;.beanslide&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$slideshow</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;No slideshow found on the page %s&quot;</span><span class="p">,</span> 
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getCurrentUrl</span><span class="p">()));</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html#document-index">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-intro">Testing your site with the Drupal Extension to Behat and Mink</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-requirements">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-localinstall">Stand-alone installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-globalinstall">System-wide installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-drivers">Drupal Extension Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-blackbox">Blackbox Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-drush">Drush Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-drupalapi">Drupal API Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-subcontexts">Contributed Module Subcontexts</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>