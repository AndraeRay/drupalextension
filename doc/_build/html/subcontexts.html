

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contributed Module Subcontexts &mdash; the Drupal Extension to Behat and Mink 1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="the Drupal Extension to Behat and Mink 1.1 documentation" href="index.html"/>
        <link rel="prev" title="Drupal API Driver" href="drupalapi.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> the Drupal Extension to Behat and Mink</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Testing your site with the Drupal Extension to Behat and Mink</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-do-behat-and-mink-do">What do Behat and Mink Do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-does-the-drupal-extension-add">What does the Drupal Extension add?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">System Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements.html#meet-the-system-requirements">Meet the system requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="localinstall.html">Stand-alone installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="globalinstall.html">System-wide installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#install-composer">Install Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#install-the-drupal-extension">Install the Drupal Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#set-up-tests">Set up tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drivers.html">Drupal Extension Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="blackbox.html">Blackbox Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blackbox.html#region-steps">Region steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="blackbox.html#example">Example:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drush.html">Drush Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drush.html#install-drush">Install Drush</a></li>
<li class="toctree-l2"><a class="reference internal" href="drush.html#create-a-drush-alias">Create a Drush alias</a></li>
<li class="toctree-l2"><a class="reference internal" href="drush.html#enable-the-drush-driver-in-the-behat-yml">Enable the Drush driver in the behat.yml</a></li>
<li class="toctree-l2"><a class="reference internal" href="drush.html#calling-the-drush-driver">Calling the Drush driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drupalapi.html">Drupal API Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drupalapi.html#enable-the-drupal-api-driver">Enable the Drupal API Driver</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Contributed Module Subcontexts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#discovering-subcontexts">Discovering SubContexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disable-autoloading">Disable autoloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for-contributors">For Contributors</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">the Drupal Extension to Behat and Mink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Contributed Module Subcontexts</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/subcontexts.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="contributed-module-subcontexts">
<h1>Contributed Module Subcontexts<a class="headerlink" href="#contributed-module-subcontexts" title="Permalink to this headline">¶</a></h1>
<p>Although not yet a wide-spread practice, the Drupal Extension to Behat and Mink
makes it easy for maintainers to include custom step definitions in their
contributed projects.</p>
<div class="section" id="discovering-subcontexts">
<h2>Discovering SubContexts<a class="headerlink" href="#discovering-subcontexts" title="Permalink to this headline">¶</a></h2>
<p>In order to use contributed step definitions, define the search path in the
behat.yml</p>
<p>// sites/default/behat-tests/behat.yml</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drupal&#39;</span> 
      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">drupal</span><span class="p-Indicator">:</span> 
        <span class="l-Scalar-Plain">drupal_root</span><span class="p-Indicator">:</span> <span class="s">&#39;/var/www/seven/drupal&#39;</span> 
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
<span class="hll">      <span class="l-Scalar-Plain">subcontexts</span><span class="p-Indicator">:</span>
</span><span class="hll">        <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
</span><span class="hll">          <span class="p-Indicator">-</span> <span class="s">&quot;/var/www/seven/drupal/sites/all&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>The Drupal Extension will search recursively within the directory or
directories specified to discover and load any file ending in behat.inc This
system, although created with Drupal contrib projects in mind, searches where
it&#8217;s pointed, so you can also use it for your own subcontexts, a strategy you
might employ to re-use step definitions particular to your shop or company&#8217;s
development patterns.</p>
</div>
<div class="section" id="disable-autoloading">
<h2>Disable autoloading<a class="headerlink" href="#disable-autoloading" title="Permalink to this headline">¶</a></h2>
<p>Autoloading can be disabled in the behat.yml file temorarily with the
following:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drupal&#39;</span> 
      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">drupal</span><span class="p-Indicator">:</span> 
        <span class="l-Scalar-Plain">drupal_root</span><span class="p-Indicator">:</span> <span class="s">&#39;/var/www/seven/drupal&#39;</span> 
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
      <span class="l-Scalar-Plain">subcontexts</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
          <span class="p-Indicator">-</span> <span class="s">&quot;/var/www/seven/drupal/sites/all&quot;</span>
<span class="hll">        <span class="l-Scalar-Plain">autoload</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="section" id="for-contributors">
<h2>For Contributors<a class="headerlink" href="#for-contributors" title="Permalink to this headline">¶</a></h2>
<p>Read a detailed discussion of <a class="reference external" href="http://docs.behat.org/guides/4.context.html#using-subcontexts">using sucontexts</a> on the Behat
site.</p>
<p>With regard to the Drupal Extension:</p>
<ul class="simple">
<li>Save custom step definitions in a file ending with <cite>.behat.inc</cite> Just like
functions, preface the filename with the project&#8217;s machine name to prevent
namespace collisions.</li>
<li>Writing step definitions for the subcontext is only slighly different than
writing them for the main context.</li>
</ul>
<p>Your subcontext must include, at a minimum, lines 7 and 8 below.</p>
<p>// sites/all/modules/beanslide/beanslide.behat.inc</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Provide Behat step-definitions as Drupal Extension subcontexts.</span>
<span class="sd"> */</span>

<span class="hll"><span class="k">use</span> <span class="nx">Drupal\DrupalExtension\Context\DrupalSubContextInterface</span><span class="p">;</span>
</span><span class="hll"><span class="k">use</span> <span class="nx">Behat\Behat\Context\BehatContext</span><span class="p">;</span>
</span>
<span class="hll"><span class="k">class</span> <span class="nc">BeanslideSubContext</span> <span class="k">extends</span> <span class="nx">BehatContext</span> <span class="k">implements</span> 
</span><span class="hll">  <span class="nx">DrupalSubContextInterface</span> <span class="p">{</span>
</span><span class="hll">  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getAlias</span><span class="p">()</span> <span class="p">{</span>
</span>    <span class="k">return</span> <span class="s1">&#39;beanslide&#39;</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>You&#8217;ll also need to call the main context in order to access the session:</p>
<p>// sites/all/modules/beanslide/beanslide.behat.inc</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span> 

  <span class="sd">/**</span>
<span class="sd">   * @Then /^I should see a slideshow$/</span>
<span class="hll"><span class="sd">   */</span>
</span>  <span class="k">public</span> <span class="k">function</span> <span class="nf">assertSlideshowExists</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$slideshow</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMainContext</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getPage</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">,</span> <span class="s1">&#39;.beanslide&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$slideshow</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;No slideshow found on the page %s&quot;</span><span class="p">,</span> 
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getCurrentUrl</span><span class="p">()));</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="drupalapi.html" class="btn btn-neutral" title="Drupal API Driver"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>