<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Drupal API Driver &mdash; the Drupal Extension to Behat and Mink 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="the Drupal Extension to Behat and Mink 1.1 documentation" href="index.html" />
    <link rel="next" title="Contributed Module Subcontexts" href="subcontexts.html" />
    <link rel="prev" title="Drush Driver" href="drush.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="subcontexts.html" title="Contributed Module Subcontexts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="drush.html" title="Drush Driver"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="drupal-api-driver">
<h1>Drupal API Driver<a class="headerlink" href="#drupal-api-driver" title="Permalink to this headline">¶</a></h1>
<p>The Drupal API Driver is the fastest and the most powerful of the three
drivers. Its biggest limitation is that the tests must run on the same server
as the Drupal site.</p>
<div class="section" id="enable-the-drupal-api-driver">
<h2>Enable the Drupal API Driver<a class="headerlink" href="#enable-the-drupal-api-driver" title="Permalink to this headline">¶</a></h2>
<p>To enable the Drupal API driver, edit the behat.yml file, change the api_driver
to drupal and add the path to the local Drupal installation as shown below:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="x">default:</span>
<span class="x">  paths:</span>
<span class="x">    features: &#39;features&#39;</span>
<span class="x">  extensions:</span>
<span class="x">    Behat\MinkExtension\Extension:</span>
<span class="x">      goutte: ~</span>
<span class="x">      selenium2: ~</span>
<span class="x">      base_url: http://seven.l</span>
<span class="x">    Drupal\DrupalExtension\Extension:</span>
<span class="x">      blackbox: ~</span>
<span class="hll"><span class="x">      api_driver: &#39;drupal&#39; </span>
</span><span class="x">      drush:</span>
<span class="x">        alias: &#39;local&#39;</span>
<span class="x">      drupal: </span>
<span class="x">        drupal_root: &#39;/var/www/seven/drupal&#39; </span>
<span class="x">      region_map:</span>
<span class="x">        footer: &quot;#footer&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It&#8217;s fine to leave the information for the drush driver in the file. It&#8217;s
the api_driver value that declares which setting will be used for scenarios
tagged &#64;api.</p>
</div>
<p>Using this driver, you gain the ability to use all the steps in the
examples below:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">    |</span><span class="s"> First article with fields</span><span class="k"> |</span><span class="s">       1</span><span class="k"> |</span><span class="s"> PLACEHOLDER BODY</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">follow &quot;</span><span class="s">First article with fields</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the text &quot;</span><span class="s">PLACEHOLDER BODY</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create and view a node with fields</span>
<span class="k">    Given </span><span class="nf">I am viewing an &quot;</span><span class="s">Article</span><span class="nf">&quot; node:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k"> |</span><span class="s"> My article with fields!</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> body</span><span class="k">  |</span><span class="s"> A placeholder</span><span class="k">           |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">My article with fields!</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see the text &quot;</span><span class="s">A placeholder</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create users</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">     |</span><span class="s"> mail</span><span class="k">            |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> joe@example.com</span><span class="k"> |</span><span class="s"> 1</span><span class="k">      |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I visit &quot;</span><span class="s">admin/people</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Joe User</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Login as a user created during this scenario</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">      |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Test user</span><span class="k"> |</span><span class="s">      1</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am logged in as &quot;</span><span class="s">Test user</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Log out</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create a term</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am viewing a &quot;</span><span class="s">tags</span><span class="nf">&quot; term with the name &quot;</span><span class="s">My tag</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">My tag</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create many terms</span>
<span class="k">    Given </span><span class="nf">&quot;</span><span class="s">tags</span><span class="nf">&quot; terms:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">    |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag one</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag two</span><span class="k"> |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I go to &quot;</span><span class="s">admin/structure/taxonomy/tags</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see &quot;</span><span class="s">Tag one</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see &quot;</span><span class="s">Tag two</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create nodes with specific authorship</span>
<span class="k">    Given </span><span class="nf">users:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">     |</span><span class="s"> mail</span><span class="k">            |</span><span class="s"> status</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> joe@example.com</span><span class="k"> |</span><span class="s"> 1</span><span class="k">      |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">&quot;</span><span class="s">article</span><span class="nf">&quot; nodes:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k">          |</span><span class="s"> author</span><span class="k">   |</span><span class="s"> body</span><span class="k">             |</span><span class="s"> promote</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Article by Joe</span><span class="k"> |</span><span class="s"> Joe User</span><span class="k"> |</span><span class="s"> PLACEHOLDER BODY</span><span class="k"> |</span><span class="s"> 1</span><span class="k">       |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I follow &quot;</span><span class="s">Article by Joe</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the link &quot;</span><span class="s">Joe User</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Create an article with multiple term references</span>
<span class="k">    Given </span><span class="nf">&quot;</span><span class="s">tags</span><span class="nf">&quot; terms:</span>
<span class="k">    |</span><span class="s"> name</span><span class="k">      |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag one</span><span class="k">   |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag two</span><span class="k">   |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag three</span><span class="k"> |</span><span class="nf"></span>
<span class="k">    |</span><span class="s"> Tag four</span><span class="k">  |</span><span class="nf"></span>
<span class="nf">    </span><span class="k">And </span><span class="nf">&quot;</span><span class="s">article</span><span class="nf">&quot; nodes:</span>
<span class="k">    |</span><span class="s"> title</span><span class="k"> |</span><span class="s"> body</span><span class="k"> |</span><span class="s"> promote</span><span class="k"> |</span><span class="s"> field_tags</span><span class="k"> |</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Drupal API Driver</a><ul>
<li><a class="reference internal" href="#enable-the-drupal-api-driver">Enable the Drupal API Driver</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="drush.html"
                        title="previous chapter">Drush Driver</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="subcontexts.html"
                        title="next chapter">Contributed Module Subcontexts</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/drupalapi.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="subcontexts.html" title="Contributed Module Subcontexts"
             >next</a> |</li>
        <li class="right" >
          <a href="drush.html" title="Drush Driver"
             >previous</a> |</li>
        <li><a href="index.html">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>