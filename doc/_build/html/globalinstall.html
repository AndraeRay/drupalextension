<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>System-wide installation &mdash; the Drupal Extension to Behat and Mink 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="the Drupal Extension to Behat and Mink 1.1 documentation" href="index.html" />
    <link rel="next" title="Drupal Extension Drivers" href="drivers.html" />
    <link rel="prev" title="Stand-alone installation" href="localinstall.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="drivers.html" title="Drupal Extension Drivers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="localinstall.html" title="Stand-alone installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="system-wide-installation">
<h1>System-wide installation<a class="headerlink" href="#system-wide-installation" title="Permalink to this headline">¶</a></h1>
<p>A system-wide installation allows you to maintain a single copy of the testing
toolset and use it for multiple test environments. Configuuration is slightly
more complex than the stand-alone installation but many people prefer the
flexibility and ease-of-maintenance this setup provides.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>To install the Drupal Extension globally:</p>
<ol class="arabic simple">
<li>Install Composer</li>
<li>Install the Drupal Extension in <cite>/opt/drupalextension</cite></li>
<li>Create an alias to the behat binary in <cite>/usr/local/bin</cite></li>
<li>Create your test folder</li>
</ol>
</div>
<div class="section" id="install-composer">
<h2>Install Composer<a class="headerlink" href="#install-composer" title="Permalink to this headline">¶</a></h2>
<p>Composer is a PHP dependency manager that will make sure all the pieces you
need get installed. <a class="reference external" href="http://getcomposer.org/doc/00-intro.md#globally">Full directions for global installation</a> and more information can be
found on the <a class="reference external" href="http://getcomposer.org/">Composer website</a>.:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -sS https://getcomposer.org/installer |
php mv composer.phar /usr/local/bin/composer
</pre></div>
</div>
</div>
<div class="section" id="install-the-drupal-extension">
<h2>Install the Drupal Extension<a class="headerlink" href="#install-the-drupal-extension" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Make a directory in /opt (or wherever you choose) for the Drupal Extension:</p>
<div class="highlight-python"><div class="highlight"><pre>cd opt/
mkdir drupalextension
cd drupalextension/
</pre></div>
</div>
</li>
</ol>
<ol class="arabic simple" start="2">
<li>Create a file called <cite>composer.json</cite> and include the following:</li>
</ol>
<blockquote>
<div><div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;require&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;drupal/drupal-extension&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0.*@stable&quot;</span>
<span class="p">},</span>
  <span class="s2">&quot;config&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;bin-dir&quot;</span><span class="o">:</span> <span class="s2">&quot;bin/&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p class="first">Run the install command:</p>
<div class="highlight-python"><div class="highlight"><pre>composer install
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div>It will be a bit before you start seeing any output. It will also suggest
that you install additional tools, but they&#8217;re not normally needed so you can
savely ignore that message.</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">Test that your install worked by typing the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">behat</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>If you were successful, you&#8217;ll see the help output.</p>
</li>
<li><p class="first">Make the binary available system-wide:</p>
<div class="highlight-python"><div class="highlight"><pre>ln -s behat /usr/local/bin/behat
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="set-up-tests">
<h2>Set up tests<a class="headerlink" href="#set-up-tests" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Create the directory that will hold your tests. There is no technical
reason this needs to be inside the Drupal directory at all. It is best to
keep them in the same version control repository so that the tests match the
version of the site they are written for.</li>
</ol>
<blockquote>
<div><p>One clear pattern is to keep them in the sites folder as follows:</p>
<p>Single site: <cite>sites/default/behat-tests</cite></p>
<p>Multisite or named single site: <cite>/sites/my.domain.com/behat-tests</cite></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Wherever you make your test folder, inside it create the behat.yml file:</li>
</ol>
<blockquote>
<div><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Edit features/bootstrap/FeatureContext.php so that it matches the following:</li>
</ol>
<blockquote>
<div><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Behat\Behat\Context\ClosuredContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\TranslatedContextInterface</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Context\BehatContext</span><span class="p">,</span>
    <span class="nx">Behat\Behat\Exception\PendingException</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Behat\Gherkin\Node\PyStringNode</span><span class="p">,</span>
    <span class="nx">Behat\Gherkin\Node\TableNode</span><span class="p">;</span>

<span class="c1">//</span>
<span class="c1">// Require 3rd-party libraries here:</span>
<span class="c1">//</span>
<span class="c1">//   require_once &#39;PHPUnit/Autoload.php&#39;;</span>
<span class="c1">//   require_once &#39;PHPUnit/Framework/Assert/Functions.php&#39;;</span>
<span class="c1">//</span>

<span class="sd">/**</span>
<span class="sd"> * Features context.</span>
<span class="sd"> */</span>
<span class="hll"><span class="c1">// class FeatureContext extends BehatContext </span>
</span><span class="hll"><span class="k">class</span> <span class="nc">FeatureContext</span> <span class="k">extends</span> <span class="nx">Drupal\DrupalExtension\Context\DrupalContext</span>
</span><span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Initializes context.</span>
<span class="sd">     * Every scenario gets its own context object.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array $parameters context parameters (set them in behat.yml)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Initialize your context here</span>
    <span class="p">}</span>

<span class="c1">//</span>
<span class="c1">// Place your definition and hook methods here:</span>
<span class="c1">//</span>
<span class="c1">//    /**</span>
<span class="c1">//     * @Given /^I have done something with &quot;([^&quot;]*)&quot;$/</span>
<span class="c1">//     */</span>
<span class="c1">//    public function iHaveDoneSomethingWith($argument)</span>
<span class="c1">//    {</span>
<span class="c1">//        doSomethingWith($argument);</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This will make your FeatureContext.php aware of both the Drupal Extension and
the Mink Extension, so you&#8217;ll be able to take advantage of their drivers and
step definitions and add your own custom step definitions here.</p>
</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">To ensure everything is set up appropriately, type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">behat</span> <span class="o">-</span><span class="n">dl</span>
</pre></div>
</div>
<p>You&#8217;ll see a list of steps like the following, but longer, if you&#8217;ve
installed everything successfully:</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="nf"> </span><span class="k">Given </span><span class="nf">/^(?:that I|I) am at &quot;</span><span class="s">(?P[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     - Visit a given path, and additionally check for HTTP response code</span>
<span class="s">       200.</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iAmAt()</span>

<span class="s">  When /^I visit </span><span class="nf">&quot;(?P[^&quot;</span><span class="s">]*)</span><span class="nf">&quot;$/</span>
<span class="nf">     </span><span class="c"># Drupal\DrupalExtension\Context\DrupalContext::iVisit()</span><span class="nf"></span>

<span class="nf">  </span><span class="k">When </span><span class="nf">/^I click &quot;</span><span class="s">(?P</span><span class="nv">&lt;link&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::iClick()</span>

<span class="s"> Given /^for </span><span class="nf">&quot;(?P</span><span class="nv">&lt;field&gt;</span><span class="nf">[^&quot;</span><span class="s">]*)</span><span class="nf">&quot; I enter &quot;</span><span class="s">(?P</span><span class="nv">&lt;value&gt;</span><span class="s">[^</span><span class="nf">&quot;]*)&quot;</span><span class="s">$/</span>
<span class="s">     # Drupal\DrupalExtension\Context\DrupalContext::forIenter()</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">System-wide installation</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#install-composer">Install Composer</a></li>
<li><a class="reference internal" href="#install-the-drupal-extension">Install the Drupal Extension</a></li>
<li><a class="reference internal" href="#set-up-tests">Set up tests</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="localinstall.html"
                        title="previous chapter">Stand-alone installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="drivers.html"
                        title="next chapter">Drupal Extension Drivers</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/globalinstall.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="drivers.html" title="Drupal Extension Drivers"
             >next</a> |</li>
        <li class="right" >
          <a href="localinstall.html" title="Stand-alone installation"
             >previous</a> |</li>
        <li><a href="index.html">the Drupal Extension to Behat and Mink 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>