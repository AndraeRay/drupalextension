

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Drush Driver &mdash; the Drupal Extension to Behat and Mink 1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="the Drupal Extension to Behat and Mink 1.1 documentation" href="index.html"/>
        <link rel="next" title="Drupal API Driver" href="drupalapi.html"/>
        <link rel="prev" title="Blackbox Driver" href="blackbox.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> the Drupal Extension to Behat and Mink</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Testing your site with the Drupal Extension to Behat and Mink</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-do-behat-and-mink-do">What do Behat and Mink Do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-does-the-drupal-extension-add">What does the Drupal Extension add?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">System Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements.html#meet-the-system-requirements">Meet the system requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="localinstall.html">Stand-alone installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="globalinstall.html">System-wide installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#install-composer">Install Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#install-the-drupal-extension">Install the Drupal Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="globalinstall.html#set-up-tests">Set up tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drivers.html">Drupal Extension Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="blackbox.html">Blackbox Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blackbox.html#region-steps">Region steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="blackbox.html#example">Example:</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Drush Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-drush">Install Drush</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-drush-alias">Create a Drush alias</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enable-the-drush-driver-in-the-behat-yml">Enable the Drush driver in the behat.yml</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calling-the-drush-driver">Calling the Drush driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drupalapi.html">Drupal API Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drupalapi.html#enable-the-drupal-api-driver">Enable the Drupal API Driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="subcontexts.html">Contributed Module Subcontexts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="subcontexts.html#discovering-subcontexts">Discovering SubContexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="subcontexts.html#disable-autoloading">Disable autoloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="subcontexts.html#for-contributors">For Contributors</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">the Drupal Extension to Behat and Mink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Drush Driver</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/drush.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="drush-driver">
<h1>Drush Driver<a class="headerlink" href="#drush-driver" title="Permalink to this headline">¶</a></h1>
<p>Many tests require that a user logs into the site. With the blackbox driver,
all user creation and login would have to take place via the user interface,
which quickly becomes tedious and time consuming. You can use the Drush driver
to add users, reset passwords, and log in by following the steps below, again,
without having to write custom PHP. You can also do this with the Drupal API
driver. The main advantage of the Drush driver is that it can work when your
tests run on a different server than the site being tested.</p>
<div class="section" id="install-drush">
<h2>Install Drush<a class="headerlink" href="#install-drush" title="Permalink to this headline">¶</a></h2>
<p>See the <a class="reference external" href="https://drupal.org/project/drush">Drush project page</a> for
installation directions.</p>
</div>
<div class="section" id="create-a-drush-alias">
<h2>Create a Drush alias<a class="headerlink" href="#create-a-drush-alias" title="Permalink to this headline">¶</a></h2>
<p>You&#8217;ll need ssh-key access to a remote server to use Drush. If Drush and Drush
aliases are new to you, see the <a class="reference external" href="http://drush.ws/help">Drush site</a> for
<a class="reference external" href="http://drush.ws/examples/example.aliases.drushrc.php">detailed examples</a></p>
<p>The alias for our example looks like:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$aliases</span><span class="p">[</span><span class="s1">&#39;local&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">&#39;root&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/www/seven/drupal&#39;</span><span class="p">,</span>
  <span class="s1">&#39;uri&#39;</span>  <span class="o">=&gt;</span>  <span class="s1">&#39;seven.l&#39;</span>
<span class="p">);</span>
<span class="nv">$aliases</span><span class="p">[</span><span class="s1">&#39;git7site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">&#39;uri&#39;</span>  <span class="o">=&gt;</span>  <span class="s1">&#39;git7site.devdrupal.org&#39;</span><span class="p">,</span>
  <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;git7site.devdrupal.org&#39;</span>
<span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="enable-the-drush-driver-in-the-behat-yml">
<h2>Enable the Drush driver in the behat.yml<a class="headerlink" href="#enable-the-drush-driver-in-the-behat-yml" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="s">&#39;features&#39;</span>
  <span class="l-Scalar-Plain">extensions</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">Behat\MinkExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">goutte</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">selenium2</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://seven.l</span>
    <span class="l-Scalar-Plain">Drupal\DrupalExtension\Extension</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">blackbox</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
<span class="hll">      <span class="l-Scalar-Plain">api_driver</span><span class="p-Indicator">:</span> <span class="s">&#39;drush&#39;</span> 
</span><span class="hll">      <span class="l-Scalar-Plain">drush</span><span class="p-Indicator">:</span>
</span>        <span class="l-Scalar-Plain">alias</span><span class="p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l-Scalar-Plain">region_map</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span> <span class="s">&quot;#footer&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Line 11 isn&#8217;t strictly necessary for the Drush driver, which is the
default for the API.</p>
</div>
</div>
<div class="section" id="calling-the-drush-driver">
<h2>Calling the Drush driver<a class="headerlink" href="#calling-the-drush-driver" title="Permalink to this headline">¶</a></h2>
<p>Untagged tests use the blackbox driver. To invoke the Drush driver, tag the
scenario with &#64;api</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Drush alias</span>
<span class="nf">  In order to demonstrate the Drush driver</span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to show how to tag scenarios </span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Untagged scenario uses blackbox driver and fails</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>

<span class="hll"><span class="nf">  </span><span class="nt">@api</span><span class="nf"></span>
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Tagged scenario uses Drush driver and succeeds</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>
</pre></div>
</td></tr></table></div>
<p>If you try to run a test without that tag, it will fail.</p>
<p>Example:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Drush alias</span>
<span class="nf">  In order to demonstrate the Drush driver</span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to show how to tag scenarios</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Untagged scenario uses blackbox driver and fails</span>
<span class="nf">    </span><span class="c"># features/drush.feature:6</span><span class="nf"></span>
<span class="hll"><span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role </span>
</span><span class="hll"><span class="nf">    </span><span class="c"># FeatureContext::iAmLoggedInWithRole()</span><span class="nf"></span>
</span><span class="hll"><span class="nf">      No ability to create users in Drupal\Driver\BlackboxDriver. </span>
</span><span class="nf">      Put `</span><span class="nt">@api`</span><span class="nf"> into your feature and add an api driver </span>
<span class="nf">      (ex: `api_driver: drupal`) in behat.yml.</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;                                         </span>
<span class="nf">    </span><span class="c"># FeatureContext::iClick()</span><span class="nf"></span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;                           </span>
<span class="nf">    </span><span class="c"># FeatureContext::assertHeading()</span><span class="nf"></span>

<span class="nf">  </span><span class="nt">@api</span><span class="nf"></span>
<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Tagged scenario uses Drush driver and succeeds            </span>
<span class="nf">            </span><span class="c"># features/drush.feature:12</span><span class="nf"></span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role </span>
<span class="nf">    </span><span class="c"># FeatureContext::iAmLoggedInWithRole()</span><span class="nf"></span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;                                         </span>
<span class="nf">    </span><span class="c"># FeatureContext::iClick()</span><span class="nf"></span>
</pre></div>
</td></tr></table></div>
<p>The Drush driver give you access to all the blackbox steps, plus those used in
each of the following examples:</p>
<div class="highlight-gherkin"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">@api</span><span class="nf"></span>
<span class="k">Feature:</span><span class="nf"> Drush driver</span>
<span class="nf">  In order to show functionality added by the Drush driver </span>
<span class="nf">  As a trainer</span>
<span class="nf">  I need to use the step definitions it supports</span>

<span class="nf">  # These scenarios assume a &quot;standard&quot; install of Drupal 7.</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Drush alias</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">authenticated user</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I click &quot;</span><span class="s">My account</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the heading &quot;</span><span class="s">History</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Target links within table rows</span>
<span class="k">    Given </span><span class="nf">I am logged in as a user with the &quot;</span><span class="s">administrator</span><span class="nf">&quot; role</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am at &quot;</span><span class="s">admin/structure/types</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I click &quot;</span><span class="s">manage fields</span><span class="nf">&quot; in the &quot;</span><span class="s">Article</span><span class="nf">&quot; row</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should be on &quot;</span><span class="s">admin/structure/types/manage/article/fields</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">I should see text matching &quot;</span><span class="s">Add new field</span><span class="nf">&quot;</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Clear cache</span>
<span class="k">    Given </span><span class="nf">the cache has been cleared</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I am on the homepage</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should get a &quot;</span><span class="s">200</span><span class="nf">&quot; HTTP response</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="drupalapi.html" class="btn btn-neutral float-right" title="Drupal API Driver"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blackbox.html" class="btn btn-neutral" title="Blackbox Driver"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>